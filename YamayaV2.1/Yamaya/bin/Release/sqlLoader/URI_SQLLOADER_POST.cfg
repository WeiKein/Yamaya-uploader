UPDATE DM_DAILY_SALES_WITH_STORE_TEMP T 
SET T.SALESQTYVOLUME=NVL(T.SALESQTYBOTTLE * 
   (SELECT VOLUMECONVERSIONUNIT 
    FROM DM_ITEM WHERE ITEMCODE=T.ITEMCODEUNIT), 0) 
WHERE T.SALESDATE=TO_DATE('{0}', 'YYYYMMDD');

DELETE FROM DM_DAILY_SALES_WITH_STORE WHERE SALESDATE=TO_DATE('{0}', 'YYYYMMDD');

INSERT INTO DM_DAILY_SALES_WITH_STORE 
(CHAINID,STORECODE,ITEMCODEUNIT,SALESQTYBOTTLE,SALESQTYAMOUNT,SALESQTYVOLUME,SALESDATE) 
SELECT CHAINID,STORECODE,ITEMCODEUNIT,SUM(SALESQTYBOTTLE),SUM(SALESQTYAMOUNT),SUM(SALESQTYVOLUME),SALESDATE 
FROM DM_DAILY_SALES_WITH_STORE_TEMP 
WHERE SALESDATE=TO_DATE('{0}', 'YYYYMMDD') 
GROUP BY CHAINID,STORECODE,ITEMCODEUNIT,SALESDATE;

DELETE FROM DM_MONTHLY_SALES_WITH_STORE WHERE SALESDATE=TO_DATE('{0}', 'YYYYMMDD');

INSERT INTO DM_MONTHLY_SALES_WITH_STORE 
(CHAINID,STORECODE,ITEMCODEUNIT,SALESQTYBOTTLE,SALESQTYAMOUNT,SALESQTYVOLUME,SALESDATE) 
SELECT CHAINID,STORECODE,ITEMCODEUNIT,SALESQTYBOTTLE,SALESQTYAMOUNT,SALESQTYVOLUME,SALESDATE 
FROM DM_DAILY_SALES_WITH_STORE 
WHERE SALESDATE=TO_DATE('{0}', 'YYYYMMDD');

DELETE FROM DM_MONTHLY_PERIOD_SALES WHERE PERIOD=TO_NUMBER(SUBSTR('{0}', 1, 6));

INSERT INTO DM_MONTHLY_PERIOD_SALES 
(CHAINID,STORECODE,ITEMCODEUNIT,SALESQTYBOTTLE,SALESQTYAMOUNT,SALESQTYVOLUME,PERIOD) 
SELECT CHAINID,STORECODE,ITEMCODEUNIT,SUM(SALESQTYBOTTLE),SUM(SALESQTYAMOUNT),SUM(SALESQTYVOLUME),TO_NUMBER(SUBSTR('{0}', 1, 6)) 
FROM DM_DAILY_SALES_WITH_STORE 
WHERE TRUNC(SALESDATE, 'MM')=TRUNC(TO_DATE('{0}', 'YYYYMMDD'), 'MM') 
GROUP BY CHAINID,STORECODE,ITEMCODEUNIT,TRUNC(SALESDATE,'MM');